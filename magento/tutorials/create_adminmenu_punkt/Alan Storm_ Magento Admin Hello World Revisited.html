<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0056)http://alanstorm.com/magento_admin_hello_world_revisited -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<meta http-equiv="Content-Language" content="en-us">
	<script type="text/javascript" src="./Alan Storm_ Magento Admin Hello World Revisited_files/jquery.js"></script>
	<script type="text/javascript" src="./Alan Storm_ Magento Admin Hello World Revisited_files/jquery.simpledialog.0.1.min.js"></script>	
	<link rel="alternate" type="application/atom+xml" title="Recent Entries" href="http://alanstorm.com/atom">	
	<link rel="stylesheet" type="text/css" href="./Alan Storm_ Magento Admin Hello World Revisited_files/a.css">
	<!--[if IE]><link rel="stylesheet" type="text/css" href="/2009/css/ie.css" /><![endif]-->
	
	<link rel="stylesheet" type="text/css" href="./Alan Storm_ Magento Admin Hello World Revisited_files/jquery.simpledialog.0.1.css">	
	
	<link href="./Alan Storm_ Magento Admin Hello World Revisited_files/prettify.css" type="text/css" rel="stylesheet">
	<script type="text/javascript" src="./Alan Storm_ Magento Admin Hello World Revisited_files/prettify.js"></script>
	<script type="text/javascript" src="./Alan Storm_ Magento Admin Hello World Revisited_files/shCore.js"></script> 
	<script type="text/javascript" src="./Alan Storm_ Magento Admin Hello World Revisited_files/shBrushJScript.js"></script> 
	<script type="text/javascript" src="./Alan Storm_ Magento Admin Hello World Revisited_files/shBrushPhp.js"></script> 	
	<script type="text/javascript" src="./Alan Storm_ Magento Admin Hello World Revisited_files/shBrushXml.js"></script> 	
	<script type="text/javascript" src="./Alan Storm_ Magento Admin Hello World Revisited_files/shBrushPython.js"></script>
	<script type="text/javascript" src="./Alan Storm_ Magento Admin Hello World Revisited_files/shBrushYaml.js"></script>	
	

	<link type="text/css" rel="stylesheet" href="./Alan Storm_ Magento Admin Hello World Revisited_files/shCoreDefault.css"> 
	<script type="text/javascript">SyntaxHighlighter.all();</script> 

	
	<title>Alan Storm: Magento Admin Hello World Revisited </title>	
<script type="text/javascript" async="" src="./Alan Storm_ Magento Admin Hello World Revisited_files/embed.js"></script></head>
<body cz-shortcut-listen="true">
<div id="wrap">
	
<div id="header">
	<img src="./Alan Storm_ Magento Admin Hello World Revisited_files/title-w-header.gif" style="position:relative;top:6px;left:10px;">
</div>

<div id="content-wrap">
	<div id="sidebar">	
		        <img src="./Alan Storm_ Magento Admin Hello World Revisited_files/valve.jpg" alt="Say Yes" width="200" height="90" border="0" id="sidebar-img">
		<ul id="nav" class="nostyle">
<li class="first"><a href="http://alanstorm.com/" style="font-size: 12px;">Home</a></li> 
<li><a href="http://alanstorm.com/archives" style="font-size: 12px;">Archive</a></li> 
<li><a href="http://alanstorm.com/projects" style="font-size: 12px;">Projects</a></li> 
<li class="last"><a href="http://alanstorm.com/contact" style="font-size: 12px;">Contact</a></li>
</ul>
<h2 class="categories" style="margin-top:20px;">Article Categories</h2>
<ul id="ascategories">
	<li><a rel="category tag" href="http://alanstorm.com/category/magento">Magento</a></li>
	<li><a rel="category tag" href="http://alanstorm.com/category/magento-2">Magento 2</a></li>	
	<li><a rel="category tag" href="http://alanstorm.com/category/laravel">Laravel</a></li>	
	<li><a rel="category tag" href="http://alanstorm.com/category/orocrm">OroCRM</a></li>
	<li><a rel="category tag" href="http://alanstorm.com/category/modern_php">Modern PHP</a></li>
	<li><a rel="category tag" href="http://alanstorm.com/category/sugarcrm">SugarCRM</a></li>
	<li><a rel="category tag" href="http://alanstorm.com/category/drupal">Drupal</a></li>
	<li><a rel="category tag" href="http://alanstorm.com/category/webos">WebOS (HP/Palm)</a></li>	
	<li><a rel="category tag" href="http://alanstorm.com/category/python">Python</a></li>
	<li><a rel="category tag" href="http://alanstorm.com/category/applescript">AppleScript</a></li>
	<li><a href="http://alanstorm.com/links">Links</a> (beta)</li>
</ul>
<h2 class="categories" style="margin-top:20px;">Quickies Sites</h2>
<ul id="quickies">
    <li><a href="http://magento-quickies.alanstorm.com/">Magento Quickies</a></li>
    <li><a href="http://oro-quickies.alanstorm.com/">OroCRM Quickies</a></li>
    <li><a href="http://wordpress-quickies.alanstorm.com/">Wordpress Quickies</a></li>
</ul>
<a href="http://store.alanstorm.com/products/no-frills-magento-layout"><img src="./Alan Storm_ Magento Admin Hello World Revisited_files/no_frills_200x.png" style="display:block;margin-bottom:1em" width="200" height="275" border="0"></a>

<p>
No Frills Magento Layout is the only Magento layout book you'll ever need. 
<a href="http://store.alanstorm.com/products/no-frills-magento-layout">Get your copy today</a>!
</p>


<h2 class="categories" style="margin-top:20px;">Quickies</h2>
<p>
Development oriented blogs with less detailed, but still vital, programming tips.
</p>
<ul id="ascategories">
	<li><a href="http://magento-quickies.tumblr.com/">Magento Quickies</a></li>
	<li><a href="http://wordpressquickies.tumblr.com/">Wordpress Quickies</a></li>
	<li><a href="http://oroquickies.wordpress.com/">Oro Quickies</a></li>
</ul>

<p>Alan Storm is a human being living in Portland, OR by way of Seattle, WA by way of Portland, OR by way of Rochester, NY.  He likes making computers do things, and talks about that here.  </p>

<p id="not-resume">
He also likes to make things on the web. If you need something 
made on the web, <a href="http://alanstorm.com/site/contact">drop him a line</a>.
</p>

<p>We're a little worried about his penchant for slipping into the third person narrative form.</p>

<h2 class="rss"><a href="http://alanstorm.com/atom">Follow the Feed</a></h2>

<h2 class="twitter"><a href="http://twitter.com/alanstorm">Follow the Twitter</a></h2>
	</div>
	<div id="content">	
		<h1><a href="http://alanstorm.com/magento_admin_hello_world_revisited">Magento Admin Hello World Revisited</a></h1>

<p style="border: 1px dashed rgb(0, 0, 0); padding: 5px 10px; background-color: rgb(255, 255, 255);cursor:pointer" onclick="document.location=&#39;http://store.alanstorm.com/products/commerce-bug-2&#39;"><img src="./Alan Storm_ Magento Admin Hello World Revisited_files/cb-icon.png" height="75" width="75" align="left" style="margin-right:10px">
    Like this article?  Frustrated by Magento? Then you’ll love <a href="http://store.alanstorm.com/products/commerce-bug-2">Commerce Bug</a>, the must have debugging extension for anyone using Magento. Whether you’re just starting out or you’re a seasoned pro, Commerce Bug will save you and your team hours everyday. <a href="http://store.alanstorm.com/products/commerce-bug-2">Grab a copy</a> and start working <strong>with</strong> Magento instead of against it.
</p>

<p>Today we’re going to revisit an old topic.  Back in 2010 I <a href="http://alanstorm.com/magento_admin_controllers">wrote an article on setting up admin routes</a> in Magento.  While the article was technically sound, the techniques it described are not sanctioned by the Magento core team, which has led to incompatibilities throughout the years. </p>

<p>This article will describe the correct and blessed steps to setup a new admin page in Magento.  For the impatient, the source code for this article is <a href="http://alanstorm.com/2013/projects/Pulsestorm_Adminhello.tar">available for download</a>. </p>

<h2>Creating an Admin Route in Magento</h2>

<p>Admin routes are tied closely to the admin console’s menu items.  While it’s possible to create an admin route without a menu item, it complicates things for beginners.  This may seem like an extraneous first step, but you’ll understand the detour by the end of the article, and have the knowedge you need to setup your own menu-less admin routes. </p>

<p>Setting up a custom menu in Magento is a relatively simple configuration task. If you’re done any Magento module development, you’re familiar with a module’s <code>config.xml</code> file.  More modern versions of Magento have a second config file named <code>adminhtml.xml</code>.  This file is where configuration related to he admin console is put, and was introduced to help reduce the memory footprint of Magento’s configuration object for frontend store access.  </p>

<p>If you take a look at the <code>Mage_Catalog</code>’s <code>adminhtml.xml</code> file, you’ll see the following structure inside the second level <code>&lt;menu/&gt;</code> node.</p>

<div style="width:800px"><div><div id="highlighter_664923" class="syntaxhighlighter  xml"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml comments">&lt;!-- File: app/code/core/Mage/Catalog/etc/adminhtml.xml --&gt;</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">config</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">menu</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">catalog</code> <code class="xml color1">translate</code><code class="xml plain">=</code><code class="xml string">"title"</code> <code class="xml color1">module</code><code class="xml plain">=</code><code class="xml string">"catalog"</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">title</code><code class="xml plain">&gt;Catalog&lt;/</code><code class="xml keyword">title</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">sort_order</code><code class="xml plain">&gt;30&lt;/</code><code class="xml keyword">sort_order</code><code class="xml plain">&gt;</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">children</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">products</code> <code class="xml color1">translate</code><code class="xml plain">=</code><code class="xml string">"title"</code> <code class="xml color1">module</code><code class="xml plain">=</code><code class="xml string">"catalog"</code><code class="xml plain">&gt;</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">title</code><code class="xml plain">&gt;Manage Products&lt;/</code><code class="xml keyword">title</code><code class="xml plain">&gt;</code></div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">action</code><code class="xml plain">&gt;adminhtml/catalog_product/&lt;/</code><code class="xml keyword">action</code><code class="xml plain">&gt;</code></div><div class="line number11 index10 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">sort_order</code><code class="xml plain">&gt;0&lt;/</code><code class="xml keyword">sort_order</code><code class="xml plain">&gt;</code></div><div class="line number12 index11 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">products</code><code class="xml plain">&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number13 index12 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml comments">&lt;!-- ... --&gt;</code></div><div class="line number14 index13 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">children</code><code class="xml plain">&gt;</code></div><div class="line number15 index14 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml comments">&lt;!-- ... --&gt;</code></div><div class="line number16 index15 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">catalog</code><code class="xml plain">&gt;</code></div><div class="line number17 index16 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">menu</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div></div>

<p>This partial section of the configuration is responsible for the <code>Catalog -&gt; Manage Products</code> menu.  </p>

<p><img src="./Alan Storm_ Magento Admin Hello World Revisited_files/catalog-products-menu.png" border="0" width="700" height="291" alt="Manage Products Screenshot"></p>

<p>Magento will use the <code>&lt;title/&gt;</code> node for the menu text.  The <code>&lt;action/&gt;</code> node determines the route/URL, and the <code>&lt;sort_order/&gt;</code> node determine the sorting order for the menu in relation to the other module’s menus.  </p>

<p>The section of the configuration also uses Magento’s clumsy/verbose <code>&lt;children/&gt;</code> syntax.  Magento uses this syntax when describing hierarchical relationships.    The <code>&lt;catalog/&gt;</code> node above has three child nodes, <code>&lt;title/&gt;</code>, <code>&lt;sort_order&gt;</code>, and <code>&lt;children/&gt;</code></p>

<div style="width:800px"><div><div id="highlighter_900887" class="syntaxhighlighter  xml"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml comments">&lt;!-- File: app/code/core/Mage/Catalog/etc/adminhtml.xml --&gt;</code>&nbsp;&nbsp;&nbsp;</div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">catalog</code> <code class="xml color1">translate</code><code class="xml plain">=</code><code class="xml string">"title"</code> <code class="xml color1">module</code><code class="xml plain">=</code><code class="xml string">"catalog"</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">title</code><code class="xml plain">&gt;...&lt;/</code><code class="xml keyword">title</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">sort_order</code><code class="xml plain">&gt;...&lt;/</code><code class="xml keyword">sort_order</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">children</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">...</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">children</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">catalog</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div></div>

<p>The nodes <code>&lt;title/&gt;</code> and <code>&lt;sort_order/&gt;</code> are descriptive nodes for the parent <code>&lt;catalog&gt;</code> node.  Nodes inside the <code>&lt;children/&gt;</code> describe <strong>menu items</strong> that are children of the the top level menu item <code>Catalog</code>.  In other words, nodes that are child nodes <em>describe the parent node</em>, except for nodes inside the child node <code>&lt;children/&gt;</code>, which describe actual child menu items.  </p>

<p>This pattern is used elsewhere in the Magento configuration. It’s a little verbose, but it’s an important concept to learn if you’re going to do any non-trivial Magento development.  </p>

<h2>Setting Up our Own Menu</h2>

<p>We’re ready to start coding.  We’re going to assume you know how to <a href="http://alanstorm.com/magento_controller_hello_world">create your own empty Magento module</a>.  The module we’ll be using for this article is named <code>Pulsestorm_Adminhello</code>, located in the <code>community</code> code pool.</p>

<p>To setup a new top level menu item, create an <code>adminhtml.xml</code> file in your module with the following contents</p>

<div style="width:800px"><div><div id="highlighter_132608" class="syntaxhighlighter  xml"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml comments">&lt;!-- File: app/code/community/Pulsestorm/Adminhello/etc/adminhtml.xml --&gt;</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">config</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">menu</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">pulsestorm</code> <code class="xml color1">translate</code><code class="xml plain">=</code><code class="xml string">"title"</code> <code class="xml color1">module</code><code class="xml plain">=</code><code class="xml string">"pulsestorm_adminhello"</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">title</code><code class="xml plain">&gt;Pulse Storm&lt;/</code><code class="xml keyword">title</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">sort_order</code><code class="xml plain">&gt;1&lt;/</code><code class="xml keyword">sort_order</code><code class="xml plain">&gt;</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">children</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">example</code><code class="xml plain">&gt;</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">title</code><code class="xml plain">&gt;Example&lt;/</code><code class="xml keyword">title</code><code class="xml plain">&gt;</code></div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">sort_order</code><code class="xml plain">&gt;1&lt;/</code><code class="xml keyword">sort_order</code><code class="xml plain">&gt;</code></div><div class="line number11 index10 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">action</code><code class="xml plain">&gt;adminhtml/adminhello/index&lt;/</code><code class="xml keyword">action</code><code class="xml plain">&gt;</code></div><div class="line number12 index11 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">example</code><code class="xml plain">&gt;</code></div><div class="line number13 index12 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">children</code><code class="xml plain">&gt;</code></div><div class="line number14 index13 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">pulsestorm</code><code class="xml plain">&gt;</code></div><div class="line number15 index14 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">menu</code><code class="xml plain">&gt;</code></div><div class="line number16 index15 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">config</code><code class="xml plain">&gt;&nbsp;&nbsp;&nbsp; </code></div></div></td></tr></tbody></table></div></div></div>

<p>Here we’ve created a new top level admin menu named <code>Pulse Storm</code>, with a single item named <code>Example</code>.  Our URL/route is <code>adminhtml/adminhello/index</code>.  You’ll also notice we’ve used Magento’s standard locale translation attributes (<code>translate</code> and <code>module</code>) </p>

<div style="width:800px"><div><div id="highlighter_331858" class="syntaxhighlighter  xml"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml comments">&lt;!-- File: app/code/community/Pulsestorm/Adminhello/etc/adminhtml.xml --&gt;</code>&nbsp;&nbsp;&nbsp;</div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">pulsestorm</code> <code class="xml color1">translate</code><code class="xml plain">=</code><code class="xml string">"title"</code> <code class="xml color1">module</code><code class="xml plain">=</code><code class="xml string">"pulsestorm_adminhello"</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div></div>

<p>These attribute tell Magento the <code>&lt;title/&gt;</code> node should be translated by the <code>Mage::helper('pulsestorm_adminhello')-&gt;__($string)</code> helper method.  Because of this, we’ll need to add a standard data helper to our module. </p>

<p>To do so, make sure your module’s <code>config.xml</code> (not <code>adminhtml.xml</code>) includes the following definition for helper classes</p>

<div style="width:800px"><div><div id="highlighter_125951" class="syntaxhighlighter  xml"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">#File: app/code/community/Pulsestorm/Adminhello/etc/config.xml</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">config</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml comments">&lt;!-- ... --&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">global</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">helpers</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">pulsestorm_adminhello</code><code class="xml plain">&gt;</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">class</code><code class="xml plain">&gt;Pulsestorm_Adminhello_Helper&lt;/</code><code class="xml keyword">class</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">pulsestorm_adminhello</code><code class="xml plain">&gt;</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">helpers</code><code class="xml plain">&gt;</code></div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">global</code><code class="xml plain">&gt;</code></div><div class="line number11 index10 alt2"><code class="xml plain">&lt;/</code><code class="xml keyword">config</code><code class="xml plain">&gt;&nbsp;&nbsp;&nbsp; </code></div></div></td></tr></tbody></table></div></div></div>

<p>and that your module contains an empty <code>data</code> helper.      </p>

<div style="width:800px"><div><div id="highlighter_571976" class="syntaxhighlighter  php"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">#File: app/code/community/Pulsestorm/Adminhello/Helper/Data.php</code></div><div class="line number2 index1 alt1"><code class="php plain">&lt;?php</code></div><div class="line number3 index2 alt2"><code class="php keyword">class</code> <code class="php plain">Pulsestorm_Adminhello_Helper_Data </code><code class="php keyword">extends</code> <code class="php plain">Mage_Core_Helper_Abstract</code></div><div class="line number4 index3 alt1"><code class="php plain">{</code></div><div class="line number5 index4 alt2"><code class="php plain">}&nbsp;&nbsp;&nbsp; </code></div></div></td></tr></tbody></table></div></div></div>

<p>With the above in place, clear your cache and log into the Magento admin as a user with the special <strong>all</strong> resource action.  You should see the new menu item.</p>

<p><img src="./Alan Storm_ Magento Admin Hello World Revisited_files/pulsestorm-menu.png" border="0" width="700" height="88" alt="New Menu Screenshot"></p>

<h2>Menu ACL</h2>

<p>We’re not quite done with our menu item.  Above, we told you to log into the admin console as a user with the special <strong>all</strong> permission.  If you ignored this advice, and logged in as a user with restriced permission, you wouldn’t have seen the menu item.  </p>

<p>That’s because Magento’s admin console only renders menu items that users have <strong>explicit</strong> permission to view.  The <em>all</em> user has explicit permission to view everything, but users with assigned role resources do not.</p>

<p>Take a look at the admin menu block’s <code>_buildMenuArray</code> method</p>

<div style="width:800px"><div><div id="highlighter_723504" class="syntaxhighlighter  php"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">#File: app/code/core/Mage/Adminhtml/Block/Page/Menu.php</code></div><div class="line number2 index1 alt1"><code class="php keyword">protected</code> <code class="php keyword">function</code> <code class="php plain">_buildMenuArray(Varien_Simplexml_Element </code><code class="php variable">$parent</code><code class="php plain">=null, </code><code class="php variable">$path</code><code class="php plain">=</code><code class="php string">''</code><code class="php plain">, </code><code class="php variable">$level</code><code class="php plain">=0)</code></div><div class="line number3 index2 alt2"><code class="php plain">{</code></div><div class="line number4 index3 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;!-- ... --&gt;</code></div><div class="line number5 index4 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">foreach</code> <code class="php plain">(</code><code class="php variable">$parent</code><code class="php plain">-&gt;children() </code><code class="php keyword">as</code> <code class="php variable">$childName</code> <code class="php plain">=&gt; </code><code class="php variable">$child</code><code class="php plain">) {</code></div><div class="line number6 index5 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(1 == </code><code class="php variable">$child</code><code class="php plain">-&gt;disabled) {</code></div><div class="line number7 index6 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">continue</code><code class="php plain">;</code></div><div class="line number8 index7 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$aclResource</code> <code class="php plain">= </code><code class="php string">'admin/'</code> <code class="php plain">. (</code><code class="php variable">$child</code><code class="php plain">-&gt;resource ? (string)</code><code class="php variable">$child</code><code class="php plain">-&gt;resource : </code><code class="php variable">$path</code> <code class="php plain">. </code><code class="php variable">$childName</code><code class="php plain">);</code></div><div class="line number11 index10 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(!</code><code class="php variable">$this</code><code class="php plain">-&gt;_checkAcl(</code><code class="php variable">$aclResource</code><code class="php plain">)) {</code></div><div class="line number12 index11 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">continue</code><code class="php plain">;</code></div><div class="line number13 index12 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number14 index13 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;!-- ... main loop body ... --&gt;</code></div><div class="line number15 index14 alt2"><code class="php plain">}</code></div></div></td></tr></tbody></table></div></div></div>

<p>This loop is where Magento runs through all the <code>&lt;menu/&gt;</code> configuration nodes to extract the information it will need to render a menu item.  <strong>However</strong>, before going ahead with the main body of the loop, <strong>it uses the name of each menu node</strong> to create an ACL resource path.  </p>

<div style="width:800px"><div><div id="highlighter_415544" class="syntaxhighlighter  php"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">#File: app/code/core/Mage/Adminhtml/Block/Page/Menu.php&nbsp;&nbsp;&nbsp; </code></div><div class="line number2 index1 alt1"><code class="php variable">$aclResource</code> <code class="php plain">= </code><code class="php string">'admin/'</code> <code class="php plain">. (</code><code class="php variable">$child</code><code class="php plain">-&gt;resource ? (string)</code><code class="php variable">$child</code><code class="php plain">-&gt;resource : </code><code class="php variable">$path</code> <code class="php plain">. </code><code class="php variable">$childName</code><code class="php plain">);</code></div></div></td></tr></tbody></table></div></div></div>

<p>and then runs an ACL check on each node.  </p>

<div style="width:800px"><div><div id="highlighter_784348" class="syntaxhighlighter  php"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">#File: app/code/core/Mage/Adminhtml/Block/Page/Menu.php&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number2 index1 alt1"><code class="php keyword">if</code> <code class="php plain">(!</code><code class="php variable">$this</code><code class="php plain">-&gt;_checkAcl(</code><code class="php variable">$aclResource</code><code class="php plain">)) {</code></div><div class="line number3 index2 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">continue</code><code class="php plain">;</code></div><div class="line number4 index3 alt1"><code class="php plain">}</code></div></div></td></tr></tbody></table></div></div></div>

<p>If the check fails, Magento skips this iteration of the loop with <code>continue</code>, (in other words, the rending of that menu items is skipped)</p>

<p>In our case the ACL paths are</p>

<div style="width:800px"><div><div id="highlighter_867528" class="syntaxhighlighter  php"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">admin/pulsestorm</code></div><div class="line number2 index1 alt1"><code class="php plain">admin/pulsestorm/example</code></div></div></td></tr></tbody></table></div></div></div>

<p>ACL stands for <a href="http://en.wikipedia.org/wiki/Access_control_list">Access Control List</a>.  Covering Magento’s ACL implementation could be its own mini-book, but simply put Magento has a hierarchical tree structure that defines all sorts of permissions for backend functionality.  The hierarchy is for organization purposes — and items under the <code>&lt;admin/&gt;</code> node indicate a user has access to an entire area of the admin console.  Since our user doesn’t have access to the <code>admin/pulsestorm</code> section, a menu for the <code>admin/pulsestorm</code> section is not rendered.  </p>

<p>Unfortunately, Magento doesn’t automatically derive ACL permissions for added menu items. Whenever you add a new menu item, you also need to add nodes to your configuration defining an access control permission.  </p>

<p>To add an ACL permission for our new Pulse Storm menu item (<code>admin/pulsestorm</code>), add the following nodes to your <code>adminhtml.xml</code> file.</p>

<div style="width:800px"><div><div id="highlighter_272704" class="syntaxhighlighter  xml"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml comments">&lt;!-- File: app/code/community/Pulsestorm/Adminhello/etc/adminhtml.xml --&gt;</code>&nbsp;&nbsp;&nbsp;</div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">config</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">menu</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml comments">&lt;!-- ... --&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">menu</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">acl</code><code class="xml plain">&gt;</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">resources</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">admin</code><code class="xml plain">&gt;</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">children</code><code class="xml plain">&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">pulsestorm</code> <code class="xml color1">translate</code><code class="xml plain">=</code><code class="xml string">"title"</code> <code class="xml color1">module</code><code class="xml plain">=</code><code class="xml string">"pulsestorm_adminhello"</code><code class="xml plain">&gt;</code></div><div class="line number11 index10 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">title</code><code class="xml plain">&gt;Top Level Pulse Storm Menu Item&lt;/</code><code class="xml keyword">title</code><code class="xml plain">&gt;</code></div><div class="line number12 index11 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">sort_order</code><code class="xml plain">&gt;1&lt;/</code><code class="xml keyword">sort_order</code><code class="xml plain">&gt;</code></div><div class="line number13 index12 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">pulsestorm</code><code class="xml plain">&gt;</code></div><div class="line number14 index13 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">children</code><code class="xml plain">&gt;</code></div><div class="line number15 index14 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">admin</code><code class="xml plain">&gt;</code></div><div class="line number16 index15 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">resources</code><code class="xml plain">&gt;</code></div><div class="line number17 index16 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">acl</code><code class="xml plain">&gt;</code></div><div class="line number18 index17 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">config</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div></div>

<p>With the above in place, clear your cache and look at a role in the <code>System -&gt; Permissions -&gt; Roles</code> admin section </p>

<p><img src="./Alan Storm_ Magento Admin Hello World Revisited_files/acl-top-level.png" border="0" width="683" height="237" alt="ACL Screen Shot"></p>

<p>As you can see, we now have a new, top level ACL resource named <code>Top Level Pulse Storm Menu Item</code>.  If you grant your “non-<em>all</em>” user this permission, they’ll be able to see our <code>Pulse Storm</code> menu.  </p>

<p>To review what we did above: All ACL resource are configured under the top level <code>&lt;acl/&gt;</code> node.</p>

<div style="width:800px"><div><div id="highlighter_241213" class="syntaxhighlighter  xml"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">acl</code><code class="xml plain">&gt;</code></div><div class="line number2 index1 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">resources</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">admin</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">children</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml comments">&lt;!-- all ACL resources --&gt;</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">children</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">admin</code><code class="xml plain">&gt;</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">resources</code><code class="xml plain">&gt;</code></div><div class="line number10 index9 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">acl</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div></div>

<p>You’ll notice the same <code>&lt;children/&gt;</code> pattern we described above is being used here.  The <code>&lt;pulsestorm/&gt;</code> node name is should match the <code>&lt;menu/&gt;</code> node name, and <code>&lt;sort_order/&gt;</code> controls the position of the ACL resource in the UI.  The only reason our menu item isn’t first is the <em>Sales</em>, <em>Dashboard</em>, and <em>External Page Cache</em> ACL nodes also have a <code>sort_order</code> of <code>1</code>.</p>

<p>We’ve given the top level <code>Pulse Storm</code> menu an ACL resource.  Now we need to give the <code>Example</code> menu a similar one. Since our <code>&lt;example/&gt;</code> menu node is a child of our <code>&lt;pulsestorm/&gt;</code> menu node, we need to use the same structure for our <code>&lt;acl/&gt;</code> nodes. </p>

<div style="width:800px"><div><div id="highlighter_45463" class="syntaxhighlighter  xml"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml comments">&lt;!-- File: app/code/community/Pulsestorm/Adminhello/etc/adminhtml.xml --&gt;</code>&nbsp;&nbsp;&nbsp;</div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">config</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml comments">&lt;!-- ... --&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">acl</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">resources</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">admin</code><code class="xml plain">&gt;</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">children</code><code class="xml plain">&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">pulsestorm</code> <code class="xml color1">translate</code><code class="xml plain">=</code><code class="xml string">"title"</code> <code class="xml color1">module</code><code class="xml plain">=</code><code class="xml string">"pulsestorm_adminhello"</code><code class="xml plain">&gt;</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">title</code><code class="xml plain">&gt;Top Level Pulse Storm Menu Item&lt;/</code><code class="xml keyword">title</code><code class="xml plain">&gt;</code></div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">sort_order</code><code class="xml plain">&gt;1&lt;/</code><code class="xml keyword">sort_order</code><code class="xml plain">&gt;</code></div><div class="line number11 index10 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">children</code><code class="xml plain">&gt;</code></div><div class="line number12 index11 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">example</code><code class="xml plain">&gt;</code></div><div class="line number13 index12 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">title</code><code class="xml plain">&gt;Example Menu Item&lt;/</code><code class="xml keyword">title</code><code class="xml plain">&gt;</code></div><div class="line number14 index13 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">example</code><code class="xml plain">&gt;</code></div><div class="line number15 index14 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">children</code><code class="xml plain">&gt;</code></div><div class="line number16 index15 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">pulsestorm</code><code class="xml plain">&gt;</code></div><div class="line number17 index16 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">children</code><code class="xml plain">&gt;</code></div><div class="line number18 index17 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">admin</code><code class="xml plain">&gt;</code></div><div class="line number19 index18 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">resources</code><code class="xml plain">&gt;</code></div><div class="line number20 index19 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">acl</code><code class="xml plain">&gt;</code></div><div class="line number21 index20 alt2"><code class="xml plain">&lt;/</code><code class="xml keyword">config</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div></div>

<p>As you can see, we’ve added an <code>&lt;example/&gt;</code> node under <code>&lt;pulsestorm/&gt;</code>’s <code>&lt;children/&gt;</code> node.  This will give us a new ACL resource under <code>Top Level Pulse Storm Menu Item</code>.</p>

<p><img src="./Alan Storm_ Magento Admin Hello World Revisited_files/acl-both.png" border="0" width="683" height="237" alt="ACL Screenshot"></p>

<p>Assign this new resource to any user in your system, clear your cache, and they’ll have access to the <code>Example</code> menu under the top level <code>Pulse Storm</code> menu.</p>

<p><strong>Important</strong>: ACL resource are cached in the PHP session object.  This means it’s often necessary to log in and log out to view changes related to newly configured ACL resources.  </p>

<h2>Magento Admin URLs</h2>

<p>We’re almost ready to get to our controller file.  Before we do, let’s take a look at the structure of a Magento admin URL.  If you look at the <code>Catalog -&gt; Manage Products</code> url (expand the menu, and then right-click to copy), a few things stand out abou the URL</p>

<pre><code>http://magento.example.com/index.php/admin/catalog_product/index/key/1c95163f6d9e1q7f36cf54a74941580d/
</code></pre>

<p>The first is the <code>key</code> path paramater.    </p>

<pre><code>key/1c95163f6d9e137f36cf54a74941580d
</code></pre>

<p>This is a <a href="http://en.wikipedia.org/wiki/Cryptographic_nonce">nonce</a> that’s added to each Magento admin URL.  This helps protect the system from automated <a href="http://en.wikipedia.org/wiki/Cross-site_request_forgery">CSFR attacks</a>.   If you take a look at the URL for our <code>Pulse Storm -&gt; Example</code> menu item</p>

<pre><code>http://magento.example.com/index.php/admin/adminhello/index/key/b8584ba1ed62576e8b3e6fbbc2eb9f2c/
</code></pre>

<p>you’ll see a similar, but slightly different nonce.  Each URL has its own nonce, and if you attempt to access the product page directly (sans nonce) you’ll be pushed to the dashboard</p>

<pre><code>http://magento.example.com/index.php/admin/catalog_product/index
</code></pre>

<p>This is why we setup a menu item for our new admin URL. It’s impossible to simply visit an admin URL, you need the system to generate a nonce for you.  If you need to generate a non-menu URL for an admin page, use the <code>adminhtml/url</code> model.</p>

<pre><code>Mage::getMode('adminhtml/url')-&gt;getUrl('route/path/here');
</code></pre>

<p>Speaking of route paths, the other thing you may have noticed is our URLs use the <code>admin</code> front name</p>

<pre><code>admin/catalog_product/index
admin/adminhello/index
</code></pre>

<p>but were configured with the <code>adminhtml</code> frontname.      </p>

<div style="width:800px"><div><div id="highlighter_983718" class="syntaxhighlighter  xml"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">action</code><code class="xml plain">&gt;adminhtml/catalog_product/&lt;/</code><code class="xml keyword">action</code><code class="xml plain">&gt;</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">action</code><code class="xml plain">&gt;adminhtml/adminhello/index&lt;/</code><code class="xml keyword">action</code><code class="xml plain">&gt;&nbsp;&nbsp;&nbsp; </code></div></div></td></tr></tbody></table></div></div></div>

<p>Why the discrepancy?  When you provide Magento with a route string, you’re <strong>not</strong> providing it with a literal URL.  The first section of the route string actually indicates which <code>&lt;router/&gt;</code> node Magento should look at to <strong>find the URL’s front name</strong>.  So, <code>adminhtml</code> in the route string points to the <code>&lt;adminhtml/&gt;</code> router node, which has a <code>&lt;frontName/&gt;</code> of <code>admin</code>.  </p>

<div style="width:800px"><div><div id="highlighter_826454" class="syntaxhighlighter  xml"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml comments">&lt;!-- File: app/code/core/Mage/Adminhtml/etc/config.xml --&gt;</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">admin</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">routers</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">adminhtml</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">use</code><code class="xml plain">&gt;admin&lt;/</code><code class="xml keyword">use</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">args</code><code class="xml plain">&gt;</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">module</code><code class="xml plain">&gt;Mage_Adminhtml&lt;/</code><code class="xml keyword">module</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">frontName</code><code class="xml plain">&gt;admin&lt;/</code><code class="xml keyword">frontName</code><code class="xml plain">&gt;</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">args</code><code class="xml plain">&gt;</code></div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">adminhtml</code><code class="xml plain">&gt;</code></div><div class="line number11 index10 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">routers</code><code class="xml plain">&gt;</code></div><div class="line number12 index11 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">admin</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div></div>

<p>This means <code>admin</code> gets used in the generated URL. If you tried to use <code>admin</code> in the route string</p>

<pre><code>&lt;action&gt;admin/adminhello/index&lt;/action&gt;  
</code></pre>

<p>you’d end up with a URL that has a blank frontname, since there’s no <code>&lt;admin/&gt;</code> router.     </p>

<pre><code>http://magento.example.com/index.php//adminhello/index/key/a8584ba1ed62576e8b3e6fbbc2eb9f2c/
</code></pre>

<p>If you found that all a little confusing, don’t worry; it <strong>is</strong> confusing.  The language and concepts around URL design in Magento are very soft, and weak technical evangelism/documentation by the core team have made the things extra messy.  The fact nearly every other module in the system uses <code>&lt;routers/&gt;</code> nodes that are named the same as their <code>&lt;frontNames/&gt;</code> makes this extra tricky.  </p>

<p>Software developers who haven’t done a lot of web development always seem to bungle URL design —&nbsp;and that’s one thing Magento keeps from its Zend Framework roots.  </p>

<h2>Magento Front Name Sharing</h2>

<p>Now that we understand how Magento admin routes are generated, we’re finally able to start in on our admin console controller configuration and creation.  If you’re familiar with frontend URL routing, you know that each module in Magento “claims” a particular frontname.  For example, the <code>Mage_Catalog</code> module claims all URLs that start with the string <code>catalog</code></p>

<pre><code>http://magento.example.com/index.php/catalog/*
</code></pre>

<p>This presents a problem if you want to create a new page for the admin console.  While it’s possible to create a new <code>frontName</code> for an admin console URL, there are many shared admin console features (media browser, ajax helpers, etc.) that assume your URL starts with the <code>admin</code> frontname.  </p>

<p>This “one module”/”one frontname” concept (if not the actual code) is borrowed from Zend Framework’s default module routing implementation.  As we griped earlier, software developers who aren’t “web native” often come up with a generic URL solution that fits their needs, but creates difficulties for developers used to less rigid URL handling.  </p>

<p>Fortunately, Magento 1.3 introduced the ability for modules to <strong>share</strong> a frontname.  That’s the configuration syntax we’ll be covering below.  It’s about half an abstraction more than you’ll normally have to deal with, but consistently named admin URLs will save you time and trouble in the end. </p>

<h2>Setting up the Admin Controller</h2>

<p>As previously mentioned, the URL we’re trying to create is </p>

<pre><code>http://magento.example.com/index.php/admin/adminhello/index/
</code></pre>

<p>That’s a frontname of <code>admin</code>, a controller name of <code>adminhello</code>, and an action method name of <code>index</code>.  First, we’re going to create a controller, and then we’re going to handle the shared <code>frontName</code>. </p>

<p>Magento admin controllers share the same naming convention as frontend controllers.  The URL name of <code>adminhello</code> is transformed into a PHP classname ending in  <code>AdminhelloController</code> (preceded by the current module name), and this controller file should be placed in your module’s <code>controllers</code> folder.  </p>

<p>To implement this in our module, create the following file with the following contents.</p>

<div style="width:800px"><div><div id="highlighter_855864" class="syntaxhighlighter  php"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">#File: app/code/community/Pulsestorm/Adminhello/controllers/AdminHelloController.php</code></div><div class="line number2 index1 alt1"><code class="php plain">&lt;?php</code></div><div class="line number3 index2 alt2"><code class="php keyword">class</code> <code class="php plain">Pulsestorm_Adminhello_AdminhelloController </code><code class="php keyword">extends</code> <code class="php plain">Mage_Adminhtml_Controller_Action</code></div><div class="line number4 index3 alt1"><code class="php plain">{</code></div><div class="line number5 index4 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">indexAction()</code></div><div class="line number6 index5 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">{</code></div><div class="line number7 index6 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$this</code><code class="php plain">-&gt;loadLayout();</code></div><div class="line number8 index7 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$this</code><code class="php plain">-&gt;renderLayout();</code></div><div class="line number9 index8 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number10 index9 alt1"><code class="php plain">}&nbsp;&nbsp;&nbsp; </code></div></div></td></tr></tbody></table></div></div></div>

<p>The one key difference with an admin controller is it extends the class <code>Mage_Adminhtml_Controller_Action</code>.   This is the base admin controller, and contrains extra logic to validate the user session, process the nonce, and other tasks that don’t apply to Magento’s frontend.   Notice our <code>indexAction</code> method uses the same <code>loadLayout</code> and <code>renderLayout</code> methods as the Magento frontend.  Layout and template files for the backend can be found at <code>app/design/adminhtml</code>, and are beyond the scope of this article.</p>

<p>With our controller in place, the only thing left is to configure our module to use the <code>admin</code> frontend.  To do so, add the following node to your module’s <code>config.xml</code></p>

<div style="width:800px"><div><div id="highlighter_581924" class="syntaxhighlighter  xml"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">#File: app/code/community/Pulsestorm/Adminhello/etc/config.xml</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">config</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml comments">&lt;!-- ... --&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">admin</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">routers</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">adminhtml</code><code class="xml plain">&gt;</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">args</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">modules</code><code class="xml plain">&gt;</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">Pulsestorm_Adminhello</code> <code class="xml color1">after</code><code class="xml plain">=</code><code class="xml string">"Mage_Adminhtml"</code><code class="xml plain">&gt;Pulsestorm_Adminhello&lt;/</code><code class="xml keyword">Pulsestorm_Adminhello</code><code class="xml plain">&gt;</code></div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">modules</code><code class="xml plain">&gt;</code></div><div class="line number11 index10 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">args</code><code class="xml plain">&gt;</code></div><div class="line number12 index11 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">adminhtml</code><code class="xml plain">&gt;</code></div><div class="line number13 index12 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">routers</code><code class="xml plain">&gt;</code></div><div class="line number14 index13 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">admin</code><code class="xml plain">&gt;</code></div><div class="line number15 index14 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml comments">&lt;!-- ... --&gt;</code></div><div class="line number16 index15 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">config</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div></div>

<p>Clear your cache, and then click on our <code>Example</code> link with the above configuration and controller file in place, and you should see a blank admin page. </p>

<p><img src="./Alan Storm_ Magento Admin Hello World Revisited_files/blank.png" border="0" width="683" height="237" alt="New Admin Page Screenshot"></p>

<p>The important part of this configuration is the <code>&lt;modules/&gt;</code> node.  When you’re setting up a new frontname, you use a singular <code>&lt;module/&gt;</code>.  </p>

<div style="width:800px"><div><div id="highlighter_986078" class="syntaxhighlighter  xml"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml comments">&lt;!-- File: app/code/core/Mage/Adminhtml/etc/config.xml --&gt;</code></div><div class="line number2 index1 alt1"><code class="xml plain">&lt;</code><code class="xml keyword">admin</code><code class="xml plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">routers</code><code class="xml plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">adminhtml</code><code class="xml plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">use</code><code class="xml plain">&gt;admin&lt;/</code><code class="xml keyword">use</code><code class="xml plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">args</code><code class="xml plain">&gt;</code></div><div class="line number7 index6 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">module</code><code class="xml plain">&gt;Mage_Adminhtml&lt;/</code><code class="xml keyword">module</code><code class="xml plain">&gt;</code></div><div class="line number8 index7 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;</code><code class="xml keyword">frontName</code><code class="xml plain">&gt;admin&lt;/</code><code class="xml keyword">frontName</code><code class="xml plain">&gt;</code></div><div class="line number9 index8 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">args</code><code class="xml plain">&gt;</code></div><div class="line number10 index9 alt1"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">adminhtml</code><code class="xml plain">&gt;</code></div><div class="line number11 index10 alt2"><code class="xml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="xml plain">&lt;/</code><code class="xml keyword">routers</code><code class="xml plain">&gt;</code></div><div class="line number12 index11 alt1"><code class="xml plain">&lt;/</code><code class="xml keyword">admin</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div></div>

<p>Here the configuration is telling Magento this <strong>single module</strong> is responsible for the <code>admin</code> frontname.  Our new <code>&lt;modules/&gt;</code> node (plural) tells Magento </p>

<blockquote>
  <p>Hey, you should check these modules as well</p>
</blockquote>

<p>So, when Magento tries to find a controller file for an admin URL, it will also check for any module configured inside this <code>&lt;modules/&gt;</code> tag.</p>

<div style="width:800px"><div><div id="highlighter_417363" class="syntaxhighlighter  xml"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="xml plain">&lt;</code><code class="xml keyword">Pulsestorm_Adminhello</code> <code class="xml color1">after</code><code class="xml plain">=</code><code class="xml string">"Mage_Adminhtml"</code><code class="xml plain">&gt;Pulsestorm_Adminhello&lt;/</code><code class="xml keyword">Pulsestorm_Adminhello</code><code class="xml plain">&gt;</code></div></div></td></tr></tbody></table></div></div></div>

<p>The important part of this node is the text —&nbsp;the name of the node simply needs to be unique.  Convention dictates that it should be named the same as the module you’re configuring.  </p>

<p>The <code>after="Mage_Adminhtml"</code> attribute is important.  Without it, if your module contained a controller with the same name as another Magento module (think <code>IndexController</code>), Magento might pick your module’s controller when it should pick another.  This behavior can be used to explicitly create a controller override using the <code>before="Mage_Adminhtml"</code> analog.  This also means you should take care and choose a unique global name for your admin controllers since the possibility exists of conflicting with a third party module’s controller, and it would be impossible to add <code>before</code> nodes for every module ever created. </p>

<h2>Debugging Controller Selection</h2>

<p>If you’re having trouble getting the above code working, the <code>Mage_Core_Controller_Varien_Router_Standard::_validateControllerClassName</code> method is your best bet for resolving naming issues.</p>

<div style="width:800px"><div><div id="highlighter_549587" class="syntaxhighlighter  php"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">#File: app/code/core/Mage/Core/Controller/Varien/Router/Standard.php</code></div><div class="line number2 index1 alt1"><code class="php keyword">protected</code> <code class="php keyword">function</code> <code class="php plain">_validateControllerClassName(</code><code class="php variable">$realModule</code><code class="php plain">, </code><code class="php variable">$controller</code><code class="php plain">)</code></div><div class="line number3 index2 alt2"><code class="php plain">{</code></div><div class="line number4 index3 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$controllerFileName</code> <code class="php plain">= </code><code class="php variable">$this</code><code class="php plain">-&gt;getControllerFileName(</code><code class="php variable">$realModule</code><code class="php plain">, </code><code class="php variable">$controller</code><code class="php plain">);</code></div><div class="line number5 index4 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(!</code><code class="php variable">$this</code><code class="php plain">-&gt;validateControllerFileName(</code><code class="php variable">$controllerFileName</code><code class="php plain">)) {</code></div><div class="line number6 index5 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php plain">false;</code></div><div class="line number7 index6 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$controllerClassName</code> <code class="php plain">= </code><code class="php variable">$this</code><code class="php plain">-&gt;getControllerClassName(</code><code class="php variable">$realModule</code><code class="php plain">, </code><code class="php variable">$controller</code><code class="php plain">);</code></div><div class="line number10 index9 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(!</code><code class="php variable">$controllerClassName</code><code class="php plain">) {</code></div><div class="line number11 index10 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php plain">false;</code></div><div class="line number12 index11 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// include controller file if needed</code></div><div class="line number15 index14 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(!</code><code class="php variable">$this</code><code class="php plain">-&gt;_includeControllerClass(</code><code class="php variable">$controllerFileName</code><code class="php plain">, </code><code class="php variable">$controllerClassName</code><code class="php plain">)) {</code></div><div class="line number16 index15 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php plain">false;</code></div><div class="line number17 index16 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$controllerClassName</code><code class="php plain">;</code></div><div class="line number20 index19 alt1"><code class="php plain">}</code></div></div></td></tr></tbody></table></div></div></div>

<p>This is the section of <a href="http://alanstorm.com/category/magento#dispatch">Magento’s dispatch</a> where it creates the controller class and file name.  Adding in a few temporary <code>var_dump</code>s</p>

<div style="width:800px"><div><div id="highlighter_203827" class="syntaxhighlighter  php"><div class="toolbar"><span><a href="http://alanstorm.com/magento_admin_hello_world_revisited#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">var_dump(</code><code class="php variable">$controllerFileName</code><code class="php plain">);</code></div><div class="line number2 index1 alt1"><code class="php plain">var_dump(</code><code class="php variable">$controllerClassName</code><code class="php plain">);</code></div></div></td></tr></tbody></table></div></div></div>

<p>will show you the class name and file name Magento’s expecting for your controller.  This information will usually point to the subtle typo that’s preventing your controller from working.  If you don’t see a controller name that related to your module, it means your <code>config.xml</code> configuration is incorrect.</p>

<h2>Wrap Up</h2>

<p>That’s your admin hello world, brought up to date for Magento best practices.  Magento’s routing system is one of those places where the cost/benefits analysis of a configuration over convention system start tip towards convention.  The various non-standard ways you can configure a route in Magento and have it “work”, but not be anticipated by other system code, points towards the importance of enforcing these convention in the system itself.  Of course, these things are out of our control —&nbsp;the important thing is understanding what’s expected by Magento and ensuring our own code works within those expectations. </p>

<div class="date">Originally published May 18, 2013</div><div id="disqus_thread"><iframe id="dsq-app2" name="dsq-app2" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./Alan Storm_ Magento Admin Hello World Revisited_files/saved_resource.html" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 1325px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div>
<script type="text/javascript">
	var as_disqus_data = {"uri":"\/magento_admin_hello_world_revisited","identifier":"magentoadminhelloworldrevisited"};
	var disqus_shortname = 'alanstormdotcom'; // required: replace example with your forum shortname

	//The following are highly recommended additional parameters. Remove the slashes in front to use.
	//var disqus_identifier = 'unique_dynamic_id_1234';
	var disqus_identifier = as_disqus_data.identifier;		//'domdocument_php_stop_test';
	var disqus_url = 'http://alanstorm.com' + as_disqus_data.uri; 	//'http://alanstorm.com/domdocument_php_stop';
	jQuery(document).ready(function(){	
		/* * * DON'T EDIT BELOW THIS LINE * * */
		(function() {
			var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
			dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
			(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		})();
	});
</script>
<noscript>Please enable JavaScript to view the &lt;a href="http://disqus.com/?ref_noscript"&gt;comments powered by Disqus.&lt;/a&gt;</noscript>



		<!-- <em>This article is part of a <a href="/category/magento#admin_console">longer series</a> 
exploring the Magento Admin Console.. While this article contains useful stand-alone information, you'll want to read the <a href="/category/magento#admin_console">entire series</a> to fully understand what's going on</em>.
</em>
 -->
	</div>	
</div>

<br style="clear:left">

<div id="copyright">
	Copyright © Alan Storm 1975 – 2016 &nbsp;&nbsp; All Rights Reserved
</div>
	
</div>
<script type="text/javascript">
	$(document).ready(function () {
		$('.diagram-modal').simpleDialog();
		if(-1 == navigator.appVersion.indexOf('Mac') && -1 == navigator.appVersion.indexOf('Mac')) {
			$('ul#nav a').css('font-size','12px');
		}
		
		//prettyPrint();
	});
</script>

<script src="./Alan Storm_ Magento Admin Hello World Revisited_files/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-322263-2";
urchinTracker();
</script>

</body></html>